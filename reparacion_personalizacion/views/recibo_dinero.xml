<odoo>
  <data>
        
        <template id="reparacion_personalizacion.recibo_dinero" inherit_id="interfaces_payment.reporte_pagos_editado_multi">
           
            <xpath expr="//div[@id='original']/div/table[1]" position="replace">
                <t t-set="monto_total_suma" t-value="0" />
                <t t-foreach="payments" t-as="o">
                    <t t-foreach="o.line_ids" t-as="retencion">
                        <t t-if="retencion.account_id.id == 34819">
                            <t t-if="retencion.currency_id.name == 'USD'">
                                <t t-set="monto_total_suma" t-value="retencion.debit_ms + monto_total" />
                            </t>
                            <t t-else="">
                                <t t-set="monto_total_suma" t-value="retencion.debit + monto_total" />
                            </t>
                        </t>
                    </t>
                </t>   
                
                <table style="width:100%;">
                    <td class="izquierda" style="width:50%">
                        <strong>Número:</strong>
                        <span t-esc="payments.name"/>
                        <br/>
                        <strong>Fecha:</strong>
                        <span t-esc="fecha"/>
                        <br/>
                    </td>
                    <td style="width:50%">

                        <strong>Monto total:</strong>
                        <t t-if="monto_total_suma">
                            <span t-esc="env['interfaces_tools.tools'].format_amount(monto_total_suma,moneda)"/>
                            <span t-esc="moneda.symbol"/>
                        </t>
                        <t t-else="">
                            <span t-esc="env['interfaces_tools.tools'].format_amount(monto_total,moneda)"/>
                            <span t-esc="moneda.symbol"/>
                        </t>
                            
                        <br/>
                        <strong>Usuario:</strong>
                        <span t-esc="usuario.name"/>
                        <br/>
                    </td>
                </table>
            </xpath>
            <xpath expr="//div[@id='original']/div[2]/table" position="replace">
                <t t-set="monto_total_suma" t-value="0" />
                <t t-foreach="payments" t-as="o">
                    <t t-foreach="o.line_ids" t-as="retencion">
                        <t t-if="retencion.account_id.id == 34819">
                            <t t-if="retencion.currency_id.name == 'USD'">
                                <t t-set="monto_total_suma" t-value="retencion.debit_ms + monto_total" />
                            </t>
                            <t t-else="">
                                <t t-set="monto_total_suma" t-value="retencion.debit + monto_total" />
                            </t>
                        </t>
                    </t>
                </t>   
                <table style="width:100%">
                    <th style="width:20%"></th>
                    <th style="width:80%"></th>
                    <tr>
                        <td>
                            <strong>Recibimos de:</strong>
                        </td>
                        <td>
                            <span t-esc="partner.name"/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <strong>RUC:</strong>
                        </td>
                        <td>
                            <span t-esc="partner.vat"/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <strong>La cantidad de:</strong>
                        </td>
                        <td style="font-style:italic;background-color:gray;border-radius: 6px;padding:7px">
                            <span t-esc="moneda.currency_unit_label"/>
                            <t t-if="monto_total_suma">
                                <span t-esc="env['interfaces_tools.tools'].numero_a_letra(monto_total_suma)"/>
                                <span t-esc="moneda.symbol"/>
                            </t>
                            <t t-else="">
                                <span t-esc="env['interfaces_tools.tools'].format_amount(monto_total)"/>
                                <span t-esc="moneda.symbol"/>
                            </t>
                            <!-- <span t-esc="env['interfaces_tools.tools'].numero_a_letra(monto_total)"/> -->
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <strong>En concepto de:</strong>
                        </td>
                        <td>
                            Pago según se detalla
                        </td>
                    </tr>
                </table>
            </xpath>

            <xpath expr="//div[@id='original']/table[2]" position="replace">
                <table style="width:100%">
                    <tr>
                        <td colspan="6" style="text-align:center">
                            <strong>Líneas de pago</strong>
                        </td>
                    </tr>
                    <tr style="border:1px solid black;">
                        <th>Tipo</th>
                        <th>Banco</th>
                        <th>Nro. documento</th>
                        <th>Monto</th>
                    </tr>

                    <t t-foreach="payments" t-as="o">
                        <tr>
                            <td style="text-align:left">
                                <span t-field="o.tipo_pago"/>
                            </td>
                            <td style="text-align:left">
                                <span t-field="o.bank_id.name"/>
                            </td>
                            <td style="text-align:center">
                                <t t-if="o.tipo_pago=='Efectivo'">
                                    <span></span>
                                </t>
                                <t t-if="o.tipo_pago=='Cheque'">
                                    <span t-field="o.nro_cheque"/>
                                </t>
                                <t t-if="o.tipo_pago=='TCredito'">
                                    <span t-field="o.nro_documento"/>
                                </t>
                                <t t-if="o.tipo_pago=='Transferencia'">
                                    <span t-field="o.nro_documento"/>
                                </t>
                                <t t-if="o.tipo_pago=='Retencion'">
                                    <t t-if="o.nro_documento">
                                        <span t-field="o.nro_documento"/>
                                    </t>
                                    <t t-else="">
                                        <span></span>
                                    </t>
                                </t>
                            </td>
                            <td class="numero">
                                <span t-esc="moneda.symbol"/>
                                <span t-esc="env['interfaces_tools.tools'].format_amount(o.amount,moneda)"/>

                            </td>
                        </tr>
                        <t t-foreach="o.line_ids" t-as="retencion">
                            <t t-if="retencion.account_id.id == 34819">
                                <tr>
                                    <td style="text-align:left">
                                        <span t-field="retencion.account_id.name"/>
                                    </td>
                                    <td style="text-align:left">
                                    </td>
                                    <td style="text-align:center">
                                       <span t-field="retencion.name"/>
                                    </td>
                                    <td class="numero">
                                        <span t-esc="moneda.symbol"/>
                                        <t t-if="retencion.currency_id.name == 'USD'">
                                            <span t-esc="env['interfaces_tools.tools'].format_amount(retencion.debit_ms,moneda)"/>
                                        </t>
                                        <t t-else="">
                                            <span t-esc="env['interfaces_tools.tools'].format_amount(retencion.debit,moneda)"/>
                                        </t>                                    
                                    </td>
                                </tr>
                            </t>
                        </t>
                    </t>

                </table>
            </xpath>
           
        </template>
  </data>
</odoo>