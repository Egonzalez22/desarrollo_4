<?xml version='1.0' encoding='utf-8'?>
<odoo>
    <data>
        <template id="orden_personalizacion.payment_receipt_template">
            <t t-call="web.basic_layout">
                <t t-call="web.html_container">
                    <t t-foreach="docs" t-as="o">
                        <t t-call="orden_personalizacion.custom_external_layout_header" />
                        <t t-call="orden_personalizacion.recibo_pago" />
                        <t t-call="orden_personalizacion.custom_external_layout_footer" />
                    </t>
                </t>
            </t>
        </template>
        <template id="custom_external_layout_header">
            <div class="page">
                <link rel='stylesheet' href="/orden_personalizacion/static/src/css/report_style.css" />
                <table class="encabezado">
                    <tr>
                        <td class="enca-izq" style="border: 0px">
                            <img t-att-src='image_data_uri(o.company_id.logo)' style="width:80mm;height:20mm" />
                        </td>
                        <td class="enca-mid-0"></td>
                        <td class="enca-mid-1">
                            <p class="campos">
                                <span class="text-center" t-field="o.company_id.street" />
                            </p>
                            <p class="campos">
                                <span class="text-center" t-field="o.company_id.city" />
                                -
                                <span class="text-center" t-field="o.company_id.country_id.name" />
                            </p>
                            <p class="campos">
                                Tel:
                                <span class="text-center" t-field="o.company_id.phone" />
                            </p>
                        </td>
                        <td class="enca-der">
                            <p class="campos">
                                RUC:
                                <span class="text-center" t-field="o.company_id.vat" />
                            </p>
                            <p class="campos">
                                N°:
                                <span class="text-center" t-field="o.nro_recibo" />
                            </p>
                            <p class="campos">
                                <span t-esc="o.amount" t-options="{'widget': 'monetary', 'display_currency': o.currency_id}" />
                            </p>
                        </td>
                    </tr>
                </table>
            </div>
        </template>

        <template id="custom_external_layout_footer">
            <div class="footer">
                <link rel='stylesheet' href="/orden_personalizacion/static/src/css/report_style.css" />
                <div style='padding-top:-55px'>
                    <span style="display:inline-block; width: 300px;">
                        <!-- <span t-esc="o.date.strftime('%d')" /> -->
                        <!-- de -->
                        <!-- <span t-esc="o.custom_get_mes(o.date.month)" /> -->
                        <!-- del -->
                        <!-- <span t-esc="o.date.strftime('%Y')" /> -->
                        <!-- <br /> -->
                        <span t-field="o.company_id.city" />
                        -
                        <span t-field="o.company_id.country_id.name" />
                    </span>
                    <span style="display:inline-block; width: 300px;"></span>
                    <span style="display:inline-block; width: 150px;">Firma</span>
                </div>
            </div>
        </template>
        <template id="orden_personalizacion.recibo_pago">
            <div class="page">
                <link rel='stylesheet' href="/orden_personalizacion/static/src/css/report_style.css" />
                <div class="main-page">
                    <h3 class="text-center">
                        <t t-if="o.payment_type == 'outbound'">
                        ORDEN DE PAGO
                    </t>
                        <t t-if="o.payment_type == 'inbound'">
                        RECIBO DE DINERO                
                    </t>
                    </h3>

                    <table class="tabla-datos" style="width:100%">
                        <tr>
                            <td class="w-15">
                            Proveedor
                        </td>
                            <td class="w-55">
                                <p>
                                    :
                                    <span t-field="o.partner_id" />
                                </p>
                            </td>
                            <td class="w-10">
                                <p>Ruc</p>
                            </td>
                            <td class="w-20">
                                <t t-if="o.partner_id.parent_id">
                                    <p>
                                        :
                                        <span t-field="o.partner_id.parent_id.vat" />
                                    </p>
                                </t>
                                <t t-if="not o.partner_id.parent_id">
                                    <p>
                                        :
                                        <span t-field="o.partner_id.vat" />
                                    </p>
                                </t>
                            </td>
                        </tr>
                        <tr>
                            <td class="w-15">
                                <p>Dirección</p>
                            </td>
                            <td class="w-55">
                                <p>
                                    :
                                    <span t-field="o.partner_id.street" />
                                </p>
                            </td>
                            
                        </tr>
                        <tr>
                            <td class="w-15">
                                <p>Correo</p>
                            </td>
                            <td class="w-55">
                                <p>
                                    :
                                    <span t-field="o.partner_id.email" />
                                </p>
                            </td>
                            <td class="w-10"></td>
                            <td class="w-20"></td>
                        </tr>
                    </table>
                    <p>
                        La cantidad de guaraníes:
                        <span t-esc="o.currency_id.amount_to_text(o.amount)" />
                        ---
                    </p>
                    <t t-if="o.move_id._get_reconciled_invoices_partials()">
                        <table style='width:100%'>
                            <thead>
                                <tr>
                                    <th>
                                        <span>Fecha de la Factura</span>
                                    </th>
                                    <th>
                                        <span>Nro. Factura</span>
                                    </th>
                                    <th>
                                        <span>Nro. Factura Proveedor</span>
                                    </th>
                                    <th class="text-right">
                                        <span>Monto</span>
                                    </th>
                                    <th class="text-right">
                                        <span>Monto Pagado</span>
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr t-foreach="o.move_id._get_reconciled_invoices_partials()" t-as="rec">
                                    <t t-foreach="rec" t-as="data">
                                        <t t-set="amount" t-value="data[1]" />
                                        <t t-set="inv" t-value="data[2].move_id" />
                                    

                                        <t t-if="inv.move_type != 'entry'">
                                            <td>
                                                <span t-field="inv.invoice_date" />
                                            </td>
                                            <td>
                                                <span t-field="inv.name" />
                                            </td>
                                            <td>
                                                <span t-field="inv.ref" />
                                            </td>
                                            
                                            <td class="text-right">
                                                <span t-field="inv.amount_total" />
                                            </td>
                                            <td class="text-right">
                                                <span t-esc="amount" t-options="{'widget': 'monetary', 'display_currency': inv.currency_id}" />
                                            </td>
                                        </t>
                                    </t>
                                </tr>
                            </tbody>
                        </table>
                    </t>
                    <table>
                        <tr>
                            <td class="w-10">
                                <p>Tipo de pago</p>
                            </td>
                            <td class="w-20">
                                <p>
                                    :
                                    <span t-field="o.tipo_pago" />
                                </p>
                            </td>
                        </tr>
                    </table>
                    <!-- <t t-if="not o.move_id._get_reconciled_invoices_partials()"> -->
                    <!--     <div style="height:200px"></div> -->
                    <!-- </t> -->
                </div>
            </div>
        </template>

        <record id="orden_personalizacion.recibo_pago_paperformat" model="report.paperformat">
            <field name="name">Facturas</field>
            <field name="format">A5</field>
            <field name="orientation">Landscape</field>
            <field name="margin_top">5</field>
            <field name="margin_bottom">20</field>
            <field name="margin_left">5</field>
            <field name="margin_right">5</field>
            <field name="header_line" eval="False" />
            <field name="header_spacing">1</field>
            <field name="dpi">90</field>
        </record>
        <report id="orden_personalizacion.payment_receipt" print_report_name="(object.name)" model="account.payment" string="Recibo A5" report_type="qweb-pdf" paperformat="orden_personalizacion.recibo_pago_paperformat" name="orden_personalizacion.payment_receipt_template" />
    </data>
</odoo>
